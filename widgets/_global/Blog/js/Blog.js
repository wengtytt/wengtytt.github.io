"use strict";function _typeof(a){"@babel/helpers - typeof";return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},_typeof(a)}function ownKeys(a,b){var c=Object.keys(a);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(a);b&&(d=d.filter(function(b){return Object.getOwnPropertyDescriptor(a,b).enumerable})),c.push.apply(c,d)}return c}function _objectSpread(a){for(var b,c=1;c<arguments.length;c++)b=null==arguments[c]?{}:arguments[c],c%2?ownKeys(Object(b),!0).forEach(function(c){_defineProperty(a,c,b[c])}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(b)):ownKeys(Object(b)).forEach(function(c){Object.defineProperty(a,c,Object.getOwnPropertyDescriptor(b,c))});return a}function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function _defineProperties(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}function _createClass(a,b,c){return b&&_defineProperties(a.prototype,b),c&&_defineProperties(a,c),a}function _inherits(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&_setPrototypeOf(a,b)}function _setPrototypeOf(a,b){return _setPrototypeOf=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a},_setPrototypeOf(a,b)}function _createSuper(a){var b=_isNativeReflectConstruct();return function(){var c,d=_getPrototypeOf(a);if(b){var e=_getPrototypeOf(this).constructor;c=Reflect.construct(d,arguments,e)}else c=d.apply(this,arguments);return _possibleConstructorReturn(this,c)}}function _possibleConstructorReturn(a,b){return b&&("object"===_typeof(b)||"function"==typeof b)?b:_assertThisInitialized(a)}function _assertThisInitialized(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(a){return!1}}function _getPrototypeOf(a){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)},_getPrototypeOf(a)}var Blog=function(a){function b(){return _classCallCheck(this,b),c.apply(this,arguments)}_inherits(b,a);var c=_createSuper(b);return _createClass(b,[{key:"render",value:function render(a){var b,c;this.drawCardsMarkup(a.blogs,{holder:null!==(b=a.holder)&&void 0!==b?b:"",filters:null!==(c=a.filters)&&void 0!==c?c:[]})}},{key:"drawCardsMarkup",value:function drawCardsMarkup(a,b){var c=this;this.cardData=a;this.observer=new IntersectionObserver(function callback(a){c.handleCardIntersect(a)},{root:null,threshold:.2}),this.filters={},this.addMarkup({class:"cards-filters"},b.holder),this.drawFilters(b,a),this.addMarkup({class:"cards-innerHolder"},b.holder),this.drawVisibleCards(a)}},{key:"drawFilters",value:function drawFilters(a){var b,c=this,d=a.filters;d&&d.forEach(function(a){b=a.type,"search"===b?c.drawSearchFilter():"tab"==b&&c.drawTabFilter(a)})}},{key:"drawTabFilter",value:function drawTabFilter(a){var b=this,c=a.options,d=a.name,e=c.map(function(a){return{class:"tab-item",data:a,"data-property":d,"data-value":a}});e.unshift({class:"tab-item",data:"All","data-property":d,"data-value":""}),this.addMarkup({class:"tabs-container",data:e},".cards-filters");var f=this.find(".cards-filters .tabs-container");f.onclick=function(a){if(console.log(a.target.classList),a.target.classList.contains("tab-item")){var e=b.findAll(".tab-item");e.forEach(function(a){a.classList.remove("active")}),a.target.classList.add("active");var c=a.target.getAttribute("data-property"),d=a.target.getAttribute("data-value");b.setFilters(c,d,"includes"),b.filterCards(b.filters)}}}},{key:"drawSearchFilter",value:function drawSearchFilter(){var a=this;this.addMarkup({class:"input-container",data:[{tag:"input",class:"search-box"},{class:"search-btn",data:{tag:"svg",focusable:!1,xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",data:{tag:"path",d:"M15.5 14h-.79l-.28-.27A6.471 6.471 0 0 0 16 9.5 6.5 6.5 0 1 0 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"}}}]},".cards-filters");var b=this.find(".cards-filters .search-box");b.oninput=function(b){a.setFilters("searchTerm",b.target.value,"includes"),a.filterCards(a.filters)}}},{key:"setFilters",value:function setFilters(a,b){var c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"equals";b?this.filters=_objectSpread(_objectSpread({},this.filters),{},_defineProperty({},a,{value:b,operator:c})):delete this.filters[a]}},{key:"filterCards",value:function filterCards(a){var b=[],c=this.cardData.filter(function(c,d){var e,f,g=!0;for(var h in a)if(e=a[h].operator,f=a[h].value,"includes"==e&&!c[h].includes(f)){g=!1;break}return g&&b.push(d),g});this.drawVisibleCards(c,b)}},{key:"drawVisibleCards",value:function drawVisibleCards(a){var b,c=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],d=[];a.forEach(function(a,e){b={tag:"div",class:"card-item","data-index":c[e]||e},d.push(b)}),this.setMarkup(d,".cards-innerHolder");for(var e=this.findAll(".card-item"),f=0;f<e.length;f++)this.observer.observe(e[f])}},{key:"handleCardIntersect",value:function handleCardIntersect(a){for(var b,c,d,e,f=0;f<a.length;f++)b=a[f],b&&b.isIntersecting&&(c=b.target,e=c.getAttribute("data-index"),!c.hasChildNodes()&&(this.observer.unobserve(c),d=this.makeCard(this.cardData[e]),this.addMarkup(d,c)))}},{key:"makeCard",value:function makeCard(a){var b=a.url||"",c=a.cover||"",d=a.category||[],e=a.author||"";return{tag:"a",href:b,class:"blog-item",data:[{tag:"img",src:c,class:"blog-cover"},{class:"blog-meta",data:[{tag:"span",class:"category",data:d.join(" ")},{tag:"span",class:"author",data:e}]},{tag:"span",class:"blog-title",data:a.title||""}]}}}],[{key:"initClass",value:function initClass(){}}]),b}(__Widget);